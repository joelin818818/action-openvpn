# 🚀 1Panel + OpenVPN 远程管理工作流

这个GitHub Actions工作流用于在Ubuntu最新版本上自动化完成以下任务:

1. 🖥️ 安装1Panel服务器管理面板
2. 🔒 通过OpenVPN连接到您的服务器网络
3. 🌐 提供通过VPN分配的IP直接访问1Panel控制台的方式

## ✨ 工作流特点

- **🛡️ 安全远程访问**：通过VPN加密通道安全地访问1Panel控制台
- **🤖 完全自动化**：整个安装和连接过程不需要人工干预
- **🔌 便捷服务器管理**：无需公网IP或端口转发即可管理您的服务器
- **🔑 凭证自动提取**：自动提取并重新格式化1Panel的访问信息

## 🎯 应用场景

- 🏢 管理内网或防火墙后的服务器
- 🛑 在不暴露管理界面到公网的情况下远程管理服务器
- 🏠 在家办公时安全地访问公司服务器
- 👥 为多个管理员提供安全的远程访问方式

## 🔧 配置方法

### 📋 前提条件

- GitHub账户
- OpenVPN服务器及其配置文件(.ovpn)
- 需要安装1Panel的目标服务器

### 📝 设置步骤

1. **添加OpenVPN配置到仓库Secrets** 🔐
   
   将您的OpenVPN配置文件内容添加到仓库的Secrets中，命名为`OPENVPN_CONFIG`。
   
   路径：仓库 → Settings → Secrets and variables → Actions → New repository secret

2. **自定义工作流(可选)** ⚙️

   如果需要，您可以修改`ubuntu_openvpn.yml`文件来：
   - 调整VPN连接参数
   - 指向不同的1Panel安装源
   - 修改连接等待时间

## 📋 使用方法

> 🟢 **简单四步，即可启动工作流**

工作流配置为手动触发，您可以通过以下方式启动：

1. 在GitHub仓库页面，点击"Actions"标签
2. 选择"在最新Ubuntu上运行脚本并循环检查网络 (通过OpenVPN)"工作流
3. 点击"Run workflow"按钮
4. 确认并启动工作流

工作流运行完成后，您将在输出日志中看到以下格式的1Panel访问信息：

```diff
+ =========== 1Panel 访问信息 (通过 VPN) ===========
+ 访问地址: http://192.168.x.x:端口/路径
+ 用户名: xxxxxxxxxx
+ 密码: xxxxxxxxxx
+ =================================================
```

使用这些信息通过VPN访问您的1Panel控制台。

## 🔄 工作流详解

### 步骤1: 📥 检出代码
检出仓库代码以准备执行后续步骤。

### 步骤2: 📦 下载并执行quick_start.sh
下载1Panel的安装脚本并执行，完成1Panel的安装过程。

### 步骤3: 🔌 启动OpenVPN守护进程
配置并启动OpenVPN客户端，建立与您服务器的安全连接。

### 步骤4: 🔍 获取VPN IP并更新1Panel访问信息
获取OpenVPN分配的IP地址，结合1Panel安装生成的用户信息，生成可通过VPN直接访问的1Panel控制台地址。

### 步骤5: ⏱️ 等待OpenVPN守护进程结束
保持VPN连接以便您可以访问1Panel控制台。连接将持续到您手动终止工作流。

## ⚠️ 故障排除

- **🔴 无法获取VPN IP**：检查OpenVPN配置是否正确，确认VPN服务器能正常分配IP
- **🔴 无法连接到1Panel**：检查VPN连接是否正常，以及服务器网络路由设置
- **🔴 安装脚本错误**：查看1Panel的安装日志，确认服务器环境是否满足要求

## 🛡️ 安全建议

> ⚠️ **安全警告：请务必遵循以下安全建议**

- 🔒 使用强密码保护您的1Panel控制台
- 🔄 定期更新OpenVPN配置以提高安全性
- 🛑 在使用完毕后手动终止GitHub Actions工作流
- 🔍 定期检查和更新1Panel以防止安全漏洞

---

**📢 注意**: 此工作流可能会长时间运行以保持VPN连接。请记住在使用完毕后手动停止工作流，以避免消耗GitHub Actions的运行时间配额。

